{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import {\n    add,\n    curry,\n    divide,\n    map,\n    multiply,\n    pipe,\n    subtract,\n    sum,\n    zipWith,\n    mergeWith,\n    cloneDeep,\n} from 'lodash/fp';\n\nimport approxFix from 'approx-fix';\n\n// e.g.:\n// Vmath(divide)(v1)(v2) => v2 / 1v\n// Vrotate(angle)(v) => v ~\n// Vmath(divide)([1, 2])([4, 6]) => [4, 3]\n\n// * -------------------------------- tools\n\n// * support Array and Object\nconst Vmath = curry((fn, v2, v1) =>\n    Array.isArray(v1) ? zipWith(fn, v1, v2) : mergeWith(fn, cloneDeep(v1), v2),\n);\n\nconst VarrToObj = curry((keys, arr) =>\n    keys.reduce((o, k, i) => Object.assign(o, { [k]: arr[i] || 0 }), {}),\n);\nconst VobjToArr = curry((keys, obj) => keys.map(k => obj[k] || 0));\nconst VradianToDegree = n => (n * 180) / Math.PI;\nconst VdegreeToRadian = n => (n / 180) * Math.PI;\nconst VformatAngle = angle =>\n    Math.abs(angle % 360) === 180 ? 180 : (((angle % 360) + 540) % 360) - 180;\n\n// * ---------------- simple math\n\nconst Vminus = Vmath(subtract);\nconst Vadd = Vmath(add);\nconst Vtimes = Vmath(multiply);\nconst Vdivide = Vmath(divide);\nconst Vdot = curry((v1, v2) => v1[0] * v2[0] + v1[1] * v2[1]); // === * cos(tha)\nconst Vcross = curry((v1, v2) => v1[0] * v2[1] - v2[0] * v1[1]); // === * sin(tha)\n\n// * ---------------- vector property\n\nconst VlenOf = pipe([map(e => e ** 2), sum, Math.sqrt]);\nconst VareaOf = v => multiply(...v);\nconst VratioOf = ([x, y]) => (!y ? NaN : x / y); // 16:9 => 16 / 9\n\n// * -------------------------------- rotate and angle\n\nconst VangleBetween = curry((v1, v2) => {\n    const s = VlenOf(v1) * VlenOf(v2);\n    if (s === 0) return 0;\n\n    let r = Vdot(v1, v2) / s;\n    r = Math.min(r, 1);\n    return approxFix(VradianToDegree(Math.acos(r) * (Vcross(v1, v2) < 0 ? -1 : 1)));\n});\n\nconst VangleOf = VangleBetween([1, 0]);\n\nconst VvectorCase = {\n    '-90': [0, -1],\n    0: [1, 0],\n    90: [0, 1],\n    180: [-1, 0],\n};\n\nconst VvectorOf = angle => {\n    const normalAngle = VformatAngle(angle);\n    if (VvectorCase[normalAngle]) return VvectorCase[normalAngle];\n\n    const radian = VdegreeToRadian(normalAngle);\n    return [Math.cos(radian), Math.sin(radian)];\n};\n\nconst VrotateRaw = (angle, v) => {\n    const c = VlenOf(v);\n    if (c === 0) return v;\n\n    const radian = VdegreeToRadian(angle);\n    const cos1 = v[0] / c;\n    const sin1 = v[1] / c;\n    const cos2 = Math.cos(radian);\n    const sin2 = Math.sin(radian);\n    return [(cos1 * cos2 - sin1 * sin2) * c, (sin1 * cos2 + cos1 * sin2) * c].map(approxFix);\n};\nconst Vrotate = curry(VrotateRaw);\nconst VunRotate = curry((angle, v) => VrotateRaw(-angle, v));\n\n// * -------------------------------- export\n\nexport {\n    Vmath as math,\n    VarrToObj as arrToObj,\n    VobjToArr as objToArr,\n    VradianToDegree as radianToDegree,\n    VdegreeToRadian as degreeToRadian,\n    VformatAngle as formatAngle,\n    Vminus as minus,\n    Vadd as add,\n    Vtimes as times,\n    Vdivide as divide,\n    Vdot as dot,\n    Vcross as cross,\n    VlenOf as lenOf,\n    VareaOf as areaOf,\n    VratioOf as ratioOf,\n    VangleBetween as angleBetween,\n    VangleOf as angleOf,\n    VvectorOf as vectorOf,\n    Vrotate as rotate,\n    VunRotate as unRotate,\n};\n"],"names":["Vmath","curry","fn","v2","v1","Array","isArray","zipWith","mergeWith","cloneDeep","VarrToObj","keys","arr","reduce","o","k","i","Object","assign","VobjToArr","obj","map","VradianToDegree","n","Math","PI","VdegreeToRadian","VformatAngle","angle","abs","Vminus","subtract","Vadd","add","Vtimes","multiply","Vdivide","divide","Vdot","Vcross","VlenOf","pipe","e","sum","sqrt","VareaOf","v","VratioOf","x","y","NaN","VangleBetween","s","r","min","approxFix","acos","VangleOf","VvectorCase","VvectorOf","normalAngle","radian","cos","sin","VrotateRaw","c","cos1","sin1","cos2","sin2","Vrotate","VunRotate"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiBA;;;;;;AAOA,IAAMA,KAAK,GAAGC,QAAK,CAAC,UAACC,EAAD,EAAKC,EAAL,EAASC,EAAT;SAChBC,KAAK,CAACC,OAAN,CAAcF,EAAd,IAAoBG,UAAO,CAACL,EAAD,EAAKE,EAAL,EAASD,EAAT,CAA3B,GAA0CK,YAAS,CAACN,EAAD,EAAKO,YAAS,CAACL,EAAD,CAAd,EAAoBD,EAApB,CADnC;CAAD,CAAnB;AAIA,IAAMO,SAAS,GAAGT,QAAK,CAAC,UAACU,IAAD,EAAOC,GAAP;SACpBD,IAAI,CAACE,MAAL,CAAY,UAACC,CAAD,EAAIC,CAAJ,EAAOC,CAAP;WAAaC,MAAM,CAACC,MAAP,CAAcJ,CAAd,sBAAoBC,CAApB,EAAwBH,GAAG,CAACI,CAAD,CAAH,IAAU,CAAlC,EAAb;GAAZ,EAAiE,EAAjE,CADoB;CAAD,CAAvB;AAGA,IAAMG,SAAS,GAAGlB,QAAK,CAAC,UAACU,IAAD,EAAOS,GAAP;SAAeT,IAAI,CAACU,GAAL,CAAS,UAAAN,CAAC;WAAIK,GAAG,CAACL,CAAD,CAAH,IAAU,CAAd;GAAV,CAAf;CAAD,CAAvB;;AACA,IAAMO,eAAe,GAAG,SAAlBA,eAAkB,CAAAC,CAAC;SAAKA,CAAC,GAAG,GAAL,GAAYC,IAAI,CAACC,EAArB;CAAzB;;AACA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAAAH,CAAC;SAAKA,CAAC,GAAG,GAAL,GAAYC,IAAI,CAACC,EAArB;CAAzB;;AACA,IAAME,YAAY,GAAG,SAAfA,YAAe,CAAAC,KAAK;SACtBJ,IAAI,CAACK,GAAL,CAASD,KAAK,GAAG,GAAjB,MAA0B,GAA1B,GAAgC,GAAhC,GAAuC,CAAEA,KAAK,GAAG,GAAT,GAAgB,GAAjB,IAAwB,GAAzB,GAAgC,GADhD;CAA1B;;;AAKA,IAAME,MAAM,GAAG9B,KAAK,CAAC+B,WAAD,CAApB;AACA,IAAMC,IAAI,GAAGhC,KAAK,CAACiC,MAAD,CAAlB;AACA,IAAMC,MAAM,GAAGlC,KAAK,CAACmC,WAAD,CAApB;AACA,IAAMC,OAAO,GAAGpC,KAAK,CAACqC,SAAD,CAArB;AACA,IAAMC,IAAI,GAAGrC,QAAK,CAAC,UAACG,EAAD,EAAKD,EAAL;SAAYC,EAAE,CAAC,CAAD,CAAF,GAAQD,EAAE,CAAC,CAAD,CAAV,GAAgBC,EAAE,CAAC,CAAD,CAAF,GAAQD,EAAE,CAAC,CAAD,CAAtC;CAAD,CAAlB;;AACA,IAAMoC,MAAM,GAAGtC,QAAK,CAAC,UAACG,EAAD,EAAKD,EAAL;SAAYC,EAAE,CAAC,CAAD,CAAF,GAAQD,EAAE,CAAC,CAAD,CAAV,GAAgBA,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAtC;CAAD,CAApB;;;AAIA,IAAMoC,MAAM,GAAGC,OAAI,CAAC,CAACpB,MAAG,CAAC,UAAAqB,CAAC;kBAAIA,CAAJ,EAAS,CAAT;CAAF,CAAJ,EAAmBC,MAAnB,EAAwBnB,IAAI,CAACoB,IAA7B,CAAD,CAAnB;;AACA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAAAC,CAAC;SAAIX,WAAQ,MAAR,4BAAYW,CAAZ,EAAJ;CAAjB;;AACA,IAAMC,QAAQ,GAAG,SAAXA,QAAW;;MAAEC,CAAF;MAAKC,CAAL;;SAAa,CAACA,CAAD,GAAKC,GAAL,GAAWF,CAAC,GAAGC,CAA5B;CAAjB;;;;AAIA,IAAME,aAAa,GAAGlD,QAAK,CAAC,UAACG,EAAD,EAAKD,EAAL,EAAY;MAC9BiD,CAAC,GAAGZ,MAAM,CAACpC,EAAD,CAAN,GAAaoC,MAAM,CAACrC,EAAD,CAA7B;MACIiD,CAAC,KAAK,CAAV,EAAa,OAAO,CAAP;MAETC,CAAC,GAAGf,IAAI,CAAClC,EAAD,EAAKD,EAAL,CAAJ,GAAeiD,CAAvB;EACAC,CAAC,GAAG7B,IAAI,CAAC8B,GAAL,CAASD,CAAT,EAAY,CAAZ,CAAJ;SACOE,SAAS,CAACjC,eAAe,CAACE,IAAI,CAACgC,IAAL,CAAUH,CAAV,KAAgBd,MAAM,CAACnC,EAAD,EAAKD,EAAL,CAAN,GAAiB,CAAjB,GAAqB,CAAC,CAAtB,GAA0B,CAA1C,CAAD,CAAhB,CAAhB;CANuB,CAA3B;AASA,IAAMsD,QAAQ,GAAGN,aAAa,CAAC,CAAC,CAAD,EAAI,CAAJ,CAAD,CAA9B;AAEA,IAAMO,WAAW,GAAG;SACT,CAAC,CAAD,EAAI,CAAC,CAAL,CADS;KAEb,CAAC,CAAD,EAAI,CAAJ,CAFa;MAGZ,CAAC,CAAD,EAAI,CAAJ,CAHY;OAIX,CAAC,CAAC,CAAF,EAAK,CAAL;CAJT;;AAOA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAAA/B,KAAK,EAAI;MACjBgC,WAAW,GAAGjC,YAAY,CAACC,KAAD,CAAhC;MACI8B,WAAW,CAACE,WAAD,CAAf,EAA8B,OAAOF,WAAW,CAACE,WAAD,CAAlB;MAExBC,MAAM,GAAGnC,eAAe,CAACkC,WAAD,CAA9B;SACO,CAACpC,IAAI,CAACsC,GAAL,CAASD,MAAT,CAAD,EAAmBrC,IAAI,CAACuC,GAAL,CAASF,MAAT,CAAnB,CAAP;CALJ;;AAQA,IAAMG,UAAU,GAAG,SAAbA,UAAa,CAACpC,KAAD,EAAQkB,CAAR,EAAc;MACvBmB,CAAC,GAAGzB,MAAM,CAACM,CAAD,CAAhB;MACImB,CAAC,KAAK,CAAV,EAAa,OAAOnB,CAAP;MAEPe,MAAM,GAAGnC,eAAe,CAACE,KAAD,CAA9B;MACMsC,IAAI,GAAGpB,CAAC,CAAC,CAAD,CAAD,GAAOmB,CAApB;MACME,IAAI,GAAGrB,CAAC,CAAC,CAAD,CAAD,GAAOmB,CAApB;MACMG,IAAI,GAAG5C,IAAI,CAACsC,GAAL,CAASD,MAAT,CAAb;MACMQ,IAAI,GAAG7C,IAAI,CAACuC,GAAL,CAASF,MAAT,CAAb;SACO,CAAC,CAACK,IAAI,GAAGE,IAAP,GAAcD,IAAI,GAAGE,IAAtB,IAA8BJ,CAA/B,EAAkC,CAACE,IAAI,GAAGC,IAAP,GAAcF,IAAI,GAAGG,IAAtB,IAA8BJ,CAAhE,EAAmE5C,GAAnE,CAAuEkC,SAAvE,CAAP;CATJ;;AAWA,IAAMe,OAAO,GAAGrE,QAAK,CAAC+D,UAAD,CAArB;AACA,IAAMO,SAAS,GAAGtE,QAAK,CAAC,UAAC2B,KAAD,EAAQkB,CAAR;SAAckB,UAAU,CAAC,CAACpC,KAAF,EAASkB,CAAT,CAAxB;CAAD,CAAvB;;;;;;;;;;;;;;;;;;;;;;;"}